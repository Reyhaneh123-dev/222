<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>نمایشگاه مجموعه‌ها — ورود</title>
<style>
  :root{
    --bg1:#007bff; --bg2:#00b4d8;
    --accent:#ffd54f;
    --white: #ffffff;
  }
  html,body{height:100%;margin:0}
  body{
    font-family: Tahoma, Arial, sans-serif;
    display:flex;flex-direction:column;
    justify-content:center;align-items:center;
    height:100vh;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    color:var(--white);
    overflow:hidden;
    padding:18px;
  }

  /* header/profile */
  .profile{position:absolute; top:18px; right:18px; display:flex; gap:8px; align-items:center}
  .avatar{width:44px;height:44px;border-radius:999px;background:rgba(255,255,255,0.15);display:flex;align-items:center;justify-content:center;font-weight:700;color:white}

  /* loader area */
  .loader-wrap{display:flex;flex-direction:column;gap:18px;align-items:center}
  .title{font-size:1.5rem; letter-spacing:0.4px; text-align:center; line-height:1.6}
  .title .word{display:inline-block; padding:0 6px; opacity:0.7; transition: transform .22s, opacity .22s, color .22s; transform-origin:center bottom}
  .title .word.active{transform:translateY(-10px) scale(1.08); opacity:1; color:var(--white); text-shadow:0 8px 24px rgba(0,0,0,0.25)}

  /* three dots */
  .dotseq{display:inline-block;margin-left:6px}
  .dot{display:inline-block;width:7px;height:7px;margin:0 3px;border-radius:50%;background:rgba(255,255,255,0.35);opacity:.7; transition:transform .18s, background .18s}
  .dot.active{background:var(--white); transform:scale(1.3)}

  /* operator strip */
  .ops{display:flex;gap:14px; margin-top:6px; align-items:center; justify-content:center}
  .op{font-size:20px; background:rgba(255,255,255,0.12); padding:10px 14px; border-radius:10px; display:inline-flex; align-items:center; justify-content:center; transition: transform .22s, background .22s, box-shadow .22s}
  .op.active{transform:translateY(-10px); background:linear-gradient(90deg,#fff4d8,#fff1cc); color:#000; box-shadow:0 10px 26px rgba(0,0,0,0.14)}

  /* form */
  #userForm{display:flex; flex-direction:column; align-items:center; margin-top:12px; background:rgba(255,255,255,0.06); padding:12px;border-radius:10px}
  input{margin:6px; padding:10px 12px; font-size:15px; border-radius:8px; border:none; width:220px; background:rgba(255,255,255,0.12); color:white}
  .buttons{display:flex;gap:8px}
  button{padding:10px 14px; border-radius:8px; border:none; background:rgba(255,255,255,0.18); color:white; font-size:15px; cursor:pointer}

  /* small responsive tweak */
  @media (max-width:480px){
    .title{font-size:1.1rem}
    .op{font-size:18px; padding:8px 10px}
  }
</style>
</head>
<body>

  <div class="profile">
    <div id="userNameText" class="small" style="color:rgba(255,255,255,0.9); font-size:14px; margin-left:8px"></div>
    <div id="avatar" class="avatar">؟</div>
  </div>

  <div class="loader-wrap" aria-live="polite">
    <div class="title" id="loadingTitle" aria-hidden="false"></div>

    <div class="dotseq" id="dotSeq" aria-hidden="true">
      <span class="dot"></span><span class="dot"></span><span class="dot"></span>
    </div>

    <div class="ops" id="opStrip" aria-hidden="true">
      <!-- order: تقسیم → جمع → ضرب → تفریق (از راست به چپ نمایش داده می‌شود) -->
      <div class="op" data-op="div">÷</div>
      <div class="op" data-op="add">+</div>
      <div class="op" data-op="mul">×</div>
      <div class="op" data-op="sub">−</div>
    </div>
  </div>

  <div id="userForm">
    <input id="firstName" placeholder="نام" type="text" aria-label="نام">
    <input id="lastName" placeholder="نام خانوادگی" type="text" aria-label="نام خانوادگی">
    <div class="buttons">
      <button onclick="saveUser()">تایید و ورود</button>
      <button onclick="skipDemo()">ورود بدون نام</button>
    </div>
  </div>

<script>
// متنِ کامل که می‌خواهیم کلمه‌به‌کلمه برجسته شود:
const text = 'در حال بارگذاری نمایشگاه مجموعه‌ها ...';

// تابعی برای جدا کردن به کلمه‌ها (حفظ علائم مثل ... جدا)
function splitToWords(str){
  // جداکن: جدا کردن با فاصله اما نگه داشتن توالی نقطه‌ها و علائم
  // ساده و کافی برای این متن؛ اگر متن پیچیده‌تر شد می‌توان regex پیچیده‌تر زد
  return str.split(/\s+/).filter(Boolean);
}

// رندر کلمه‌ها به صورت span.word
const titleEl = document.getElementById('loadingTitle');
const words = splitToWords(text);
words.forEach(w=>{
  const s = document.createElement('span');
  s.className = 'word';
  s.textContent = w + ' ';
  titleEl.appendChild(s);
});
const wordEls = Array.from(titleEl.querySelectorAll('.word'));

// انیمیشن کلمه به کلمه
let wi = 0;
function stepWord(){
  // پاک‌کردن همه‌ی کلاس‌ها
  wordEls.forEach(el=>el.classList.remove('active'));
  // حلقه بزن تا به یک کلمهٔ غیرخالی برسیم
  wordEls[wi]?.classList.add('active');
  wi = (wi + 1) % wordEls.length;
}
setInterval(stepWord, 420); // سرعت: هر 420 میلی‌ثانیه یک کلمه

// سه نقطه‌ی متحرک
const dots = Array.from(document.querySelectorAll('.dot'));
let di = 0;
setInterval(()=>{
  dots.forEach(d=>d.classList.remove('active'));
  dots[di].classList.add('active');
  di = (di + 1) % dots.length;
}, 420);

// نوار عملگرها — از راست به چپ برجسته شود (مطابق خواسته)
const ops = Array.from(document.querySelectorAll('.op'));
// ترتیب فعال‌سازی: از راست به چپ => reverse NodeList
let opsOrder = ops.slice().reverse();
let oi = 0;
function stepOps(){
  ops.forEach(o=>o.classList.remove('active'));
  const current = opsOrder[oi];
  current?.classList.add('active');
  oi = (oi + 1) % opsOrder.length;
}
setInterval(stepOps, 700); // سرعت هر نماد

// پروفایل/نام کاربر
function updateAvatarAndName(){
  const user = localStorage.getItem('userName') || '';
  const avatar = document.getElementById('avatar');
  const nameText = document.getElementById('userNameText');
  if(!user){
    avatar.textContent = '؟';
    nameText.textContent = '';
    return;
  }
  const parts = user.split(' ').filter(Boolean);
  const initials = (parts[0]||'')[0] + ((parts[1]||'')[0]||'');
  avatar.textContent = initials.toUpperCase();
  nameText.textContent = user;
}
updateAvatarAndName();

// دکمه‌های ذخیره
function saveUser(){
  const f = document.getElementById('firstName').value.trim();
  const l = document.getElementById('lastName').value.trim();
  if(!f || !l){ alert('لطفاً نام و نام خانوادگی را وارد کنید'); return; }
  localStorage.setItem('userName', f + ' ' + l);
  updateAvatarAndName();
  window.location.href = 'sets.html';
}
function skipDemo(){
  localStorage.setItem('userName', 'کاربر ناشناس');
  updateAvatarAndName();
  window.location.href = 'sets.html';
}
</script>

</body>
</html>
